<app-layout [breadcrumb]="breadcrumb">
  <nz-layout class="inner-layout">
    <nz-sider nzWidth="200px" nzTheme="light">
      <ul nz-menu nzMode="inline" class="sider-menu">
        <li nz-submenu nzOpen nzTitle="subnav 1" nzIcon="user">
          <ul>
            <li nz-menu-item nzSelected>option1</li>
            <li nz-menu-item>option2</li>
            <li nz-menu-item>option3</li>
            <li nz-menu-item>option4</li>
          </ul>
        </li>
        <li nz-submenu nzTitle="subnav 2" nzIcon="laptop">
          <ul>
            <li nz-menu-item>option5</li>
            <li nz-menu-item>option6</li>
            <li nz-menu-item>option7</li>
            <li nz-menu-item>option8</li>
          </ul>
        </li>
        <li nz-submenu nzTitle="subnav 3" nzIcon="notification">
          <ul>
            <li nz-menu-item>option9</li>
            <li nz-menu-item>option10</li>
            <li nz-menu-item>option11</li>
            <li nz-menu-item>option12</li>
          </ul>
        </li>
      </ul>
    </nz-sider>
    <nz-content class="inner-content">
      <img
        class="gallery__img"
        src="{{ originalImage.imageData }}"
        alt="Original Image"
        width="100%"
      />
      <form nz-form>
        <p nz-typography *ngIf="originalImage.mimeType">
          Media type of {{ originalImage.mimeType }}
        </p>
        <p nz-typography>Current generation: {{ settings.epoch }}</p>
        <nz-form-item>
          <nz-form-label nzFor="generationSize">Generation size</nz-form-label>
          <nz-input-number
            name="generationSize"
            [nzMax]="10"
            [nzMin]="1"
            [(ngModel)]="settings.generationSize"
          >
          </nz-input-number>
        </nz-form-item>
        <button
          nz-button
          (click)="previousGeneration()"
          *ngIf="settings.epoch > 1"
        >
          Previous Generation
        </button>
        <button nz-button (click)="redoGeneration()" *ngIf="settings.epoch > 0">
          Regenerate
        </button>
        <button
          nz-button
          (click)="resetEvolution()"
          *ngIf="settings.generatedImages.length"
        >
          Reset Evolution
        </button>
      </form>

      <app-find-and-replace
        [maxLength]="originalImage.imageData.length / 2"
        (onCreateGeneration)="this.createGeneration($event)"
      ></app-find-and-replace>
      <app-swap-image-data
        [maxLength]="originalImage.imageData.length / 2"
        (onCreateGeneration)="this.createGeneration($event)"
      >
      </app-swap-image-data>

      <div class="gallery">
        <div
          class="gallery__item"
          *ngFor="let image of settings.generatedImages"
        >
          <app-canvas
            class="gallery__canvas"
            [originalImage]="originalImage"
            [modifiedImage]="image"
          ></app-canvas>
          <app-metadata
            *ngIf="!image.mutations[image.mutations.length - 1].corrupted"
            [mutation]="image.mutations[image.mutations.length - 1]"
          ></app-metadata>
        </div>
      </div>
    </nz-content>
  </nz-layout>
</app-layout>
